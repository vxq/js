-function(window, module) {
'use strict';var k="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global?global:this;function l(){k.Symbol||(k.Symbol=n);l=function(){}}var q=0;function n(a){return"jscomp_symbol_"+a+q++}function r(){l();k.Symbol.iterator||(k.Symbol.iterator=k.Symbol("iterator"));r=function(){}}function t(a){r();if(a[k.Symbol.iterator])return a[k.Symbol.iterator]();var b=0;return{next:function(){return b==a.length?{done:!0}:{done:!1,value:a[b++]}}}}
function u(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};function v(a,b){if(!a)throw Error((void 0===b?null:b)||"Assertion failed");}function w(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];console.log.apply(console,[].concat(b instanceof Array?b:u(t(b))))};function x(){this.b=[];this.a=[]}x.prototype.add=function(a){var b={};this.a.push(b);this.b.push(a);return function(){var a=this.a.indexOf(b);this.b.splice(a,1);this.a.splice(a,1)}.bind(this)};x.prototype.call=function(){for(var a=t(this.b),b=a.next();!b.done;b=a.next())b=b.value,b()};function y(a){for(var b=0;b<a.length-1;b++){var c=a[b],e=b+Math.floor(Math.random()*a.length-b);a[b]=a[e];a[e]=c}}
function z(a){a=a.getBoundingClientRect();return!(0>a.bottom||0>a.right||a.top>window.innerHeight||a.left>window.innerWidth)};function A(a,b,c){this.width=a;this.height=b;this.a=new Set(c);this.changeCallbacks=new x}Object.defineProperties(A.prototype,{agents:{configurable:!0,enumerable:!0,get:function(){return this.a}}});function B(){this.y=this.x=50;this.a=this.z=0;this.changeCallbacks=new x}function C(a,b){v(Number.isFinite(b));a.a-=b}function D(a,b){v(Number.isFinite(b));a.goTo(a.x+b*a.i,a.y+b*a.j,a.z)}
B.prototype.goTo=function(a,b,c){v(Number.isFinite(a));v(Number.isFinite(b));v(Number.isFinite(c));c=a-this.x;for(var e=b-this.y,f=Math.ceil(Math.sqrt(c*c+e*e)/4),d=0;d<f;d++)this.x+=c/f,this.y+=e/f,this.changeCallbacks.call();this.x=a;this.y=b;this.changeCallbacks.call();return Promise.resolve()};Object.defineProperties(B.prototype,{i:{configurable:!0,enumerable:!0,get:function(){return-Math.sin(2*this.a*Math.PI)}},j:{configurable:!0,enumerable:!0,get:function(){return Math.cos(2*this.a*Math.PI)}}});function E(a,b){v(Number.isFinite(a),"x = "+a+" must be a finite number");v(Number.isFinite(b),"y = "+b+" must be a finite number");this.x=a;this.y=b}function F(a){return Math.sqrt(a.x*a.x+a.y*a.y)}function H(a,b){v(Number.isFinite(b),"magnitude = "+b+" must be a finite number");var c=F(a);return 0!==c?a.scale(b/c):I(0,0)}E.prototype.scale=function(a){v(Number.isFinite(a),"magnitude = "+a+" must be a finite number");return I(a*this.x,a*this.y)};
E.prototype.add=function(a){return I(this.x+a.x,this.y+a.y)};function J(a,b){return I(a.x-b.x,a.y-b.y)}E.prototype.toString=function(){return"V("+this.x+", "+this.y+")"};var K,I=K=function(a,b){return new E(a,b)};function L(a,b){var c=this;this.width=a;this.height=b;this.changeCallbacks=new x;this.a=new Set;setInterval(function(){for(var b=new Map,a=t(c.a),d=a.next();!d.done;d=a.next()){for(var m=d.value,d=K(0,0),d=d.add(m.g),g=t(c.a),h=g.next();!h.done;h=g.next())if(h=h.value,m!==h){var p=J(h.b,m.b),G=F(p);40>G&&(G=40);h=H(p,1).scale(6.67408*m.c*h.c/Math.pow(G,2));d=d.add(h)}b.set(m,d)}a=[];m=t(c.a);for(d=m.next();!d.done;d=m.next())d=d.value,g=d.c*d.f,h=b.get(d),p=h.scale(.02/g),d.a=d.a.add(p),p=F(d.a),
p=Math.max(0,p-.001*p),d.a=4<=p||4<F(h)/g?H(d.a,p):K(0,0),0<F(d.a)&&(g=d.a.scale(.02),d.b=d.b.add(g),a.push(d));y(a);b=t(a);for(d=b.next();!d.done;d=b.next())d.value.changeCallbacks.call()},20)}Object.defineProperties(L.prototype,{agents:{configurable:!0,enumerable:!0,get:function(){return new Set(this.a)}}});function M(a,b,c){this.b=K(void 0===b?0:b,void 0===c?0:c);this.a=K(0,0);this.g=K(0,0);this.c=1E4;this.f=1;this.h=Promise.resolve();this.changeCallbacks=new x}M.prototype.goTo=function(a,b){function c(){return new Promise(function(c){function d(){var d=J(K(a,b),e.b),g=e.b.add(e.a.scale(1.5)),g=J(K(a,b),g);32>=F(d)&&10>=F(e.a)?(e.g=K(0,0),c()):e.g=H(g,175*e.c*e.f)}e.changeCallbacks.add(function(){d()});d()})}var e=this;return this.h=this.h.then(c,c)};
Object.defineProperties(M.prototype,{x:{configurable:!0,enumerable:!0,get:function(){return this.b.x}},y:{configurable:!0,enumerable:!0,get:function(){return this.b.y}},z:{configurable:!0,enumerable:!0,get:function(){return 0}}});function N(a,b){var c=a+" !== "+b;if(a!==b)throw Error((void 0===c?null:c)||"Assertion failed");};function O(a,b){var c=this;this.c=1E3*Math.random();this.b=a;this.a=b;this.cancel=b.changeCallbacks.add(function(){return void c.update(b.x,b.y,b.z)})}
O.prototype.update=function(a,b,c){a=void 0===a?0:a;b=void 0===b?0:b;c=void 0===c?0:c;z(this.b.a)&&(a-=0,b-=0,c-=0,c=Math.max(.2,Math.min(1,Math.sqrt(a*a+b*b+c*c)/100)),a=this.b.b,a.fillStyle="hsla("+this.c+", 50%, 50%, "+c+")",a.strokeStyle="rgba(255, 255, 255, "+c+")",a.beginPath(),a.lineWidth=1,a.arc(this.a.x,this.a.y,6,0,2*Math.PI),a.fill(),a.stroke(),a.strokeStyle="rgba(0, 0, 0, "+.5*c+")",a.beginPath(),a.lineWidth=2,a.arc(this.a.x,this.a.y,8,0,2*Math.PI),a.stroke())};
function P(a,b,c){this.source=a;this.x=b;this.y=c}
function Q(a){var b=this;this.c=a;this.a=document.createElement("canvas");this.a.width=this.c.width;this.a.height=this.c.height;this.a.style.cursor="crosshair";this.g=new Set;this.a.addEventListener("click",function(a){var c=b.a.width*(a.pageX-b.a.offsetLeft)/b.a.offsetWidth;a=b.a.height*(a.pageY-b.a.offsetTop)/b.a.offsetHeight;for(var d,m=t(b.c.agents),g=m.next();!g.done;g=m.next())d=g.value;if(d){var h=new P(d,c,a);b.g.add(h);d.goTo(c,a,0).then(function(){b.g.delete(h)})}});this.b=this.a.getContext("2d");
this.b.fillStyle="black";this.b.fillRect(0,0,this.c.width,this.c.height);this.f=new Map;this.h();this.c.changeCallbacks.add(this.h.bind(this));var c=+new Date;setInterval(function(){var a=+new Date,f=(a-c)/1E3;c=a;if(z(b.a)){b.b.fillStyle="rgba(0, 0, 0, "+.25*f+")";b.b.fillRect(0,0,b.c.width,b.c.height);a=Array.from(b.f.values());y(a);a=t(a);for(f=a.next();!f.done;f=a.next())f.value.update();a=Array.from(b.g);y(a);a=t(a);for(f=a.next();!f.done;f=a.next())f=f.value,b.b.strokeStyle="rgba(210, 40, 40, 0.75)",
b.b.beginPath(),b.b.lineWidth=4,b.b.moveTo(f.source.x,f.source.y),b.b.lineTo(f.x,f.y),b.b.stroke()}else b.b.fillStyle="black",b.b.fillRect(0,0,b.c.width,b.c.height)},100)}Q.prototype.h=function(){for(var a=t(this.f),b=a.next();!b.done;b=a.next())b.value.cancel();this.f=new Map;a=t(this.c.agents);for(b=a.next();!b.done;b=a.next())b=b.value,this.f.set(b,new O(this,b))};function R(){}R.prototype.test=function(){w("Let's testTheTurtles()!");S()};R.prototype.addFlatCanvasWithTurtles=function(a){var b=new A(512,512,[]),c=new Q(b);a.appendChild(c.a);S(b);return b};
R.prototype.addFlatCanvasWithFlatland=function(a){function b(){return.5+(Math.random()+Math.random()+Math.random())/3}var c=new L(512,512),e=new Q(c);a.appendChild(e.a);a=new M(0,150,50);a.a=K(200,-5);c.a.add(a);console.log(a.goTo(500,500,0));a=new M(0,400,200);a.a=K(-100,450);c.a.add(a);console.log(a.goTo(25,25,0));a=new M(0,150,175);a.a=K(-65,125);c.a.add(a);console.log(a.goTo(50,400,0));for(a=0;4>a;a++)e=new M(0,200+50*b(),200+50*b()),e.c*=10,e.f*=10,e.a=K(5-10*b(),5-10*b()),c.a.add(e);c.changeCallbacks.call();
return c};function S(a){a=void 0===a?new A(512,512,[]):a;var b=new B;a.a.add(b);a.changeCallbacks.call();N(50,b.x);N(50,b.y);D(b,50);N(50,b.x);N(100,b.y);v(Number.isFinite(.25));b.a+=.25;D(b,25);N(25,b.x);N(100,b.y);C(b,.375);D(b,100);for(a=0;12>a;a++)C(b,.0625),D(b,10);D(b,100);C(b,.25);D(b,200);for(a=0;6>a;a++)C(b,.0625),D(b,10);D(b,50);console.log("Test complete.")}var T=new R;"object"===typeof module&&null!=module&&(module.exports=T);"object"===typeof window&&null!=window&&(window.vxq=T);
}.call(typeof window == 'object' ? window: typeof this == 'object' ? this: null,typeof window == 'object' ? window : null,typeof module == 'object' ? module : null)
