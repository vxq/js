-function(window, module) {
'use strict';var f="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global?global:this;function m(){f.Symbol||(f.Symbol=n);m=function(){}}var q=0;function n(a){return"jscomp_symbol_"+a+q++}function r(){m();f.Symbol.iterator||(f.Symbol.iterator=f.Symbol("iterator"));r=function(){}}function t(a){r();if(a[f.Symbol.iterator])return a[f.Symbol.iterator]();var b=0;return{next:function(){return b==a.length?{done:!0}:{done:!1,value:a[b++]}}}}
function v(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};function w(a,b){if(!a)throw Error((void 0===b?null:b)||"Assertion failed");}function x(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];console.log.apply(console,[].concat(b instanceof Array?b:v(t(b))))};function z(){this.b=[];this.a=[]}z.prototype.add=function(a){var b={};this.a.push(b);this.b.push(a);return function(){var a=this.a.indexOf(b);this.b.splice(a,1);this.a.splice(a,1)}.bind(this)};z.prototype.call=function(){for(var a=t(this.b),b=a.next();!b.done;b=a.next())b=b.value,b()};function A(a){a=a.getBoundingClientRect();return!(0>a.bottom||0>a.right||a.top>window.innerHeight||a.left>window.innerWidth)};function B(a,b,c){this.width=a;this.height=b;this.a=new Set(c);this.changeCallbacks=new z}Object.defineProperties(B.prototype,{agents:{configurable:!0,enumerable:!0,get:function(){return this.a}}});function C(){this.y=this.x=50;this.a=this.z=0;this.changeCallbacks=new z}function D(a,b){w(Number.isFinite(b));a.a-=b}function E(a,b){w(Number.isFinite(b));a.goTo(a.x+b*a.i,a.y+b*a.j,a.z)}
C.prototype.goTo=function(a,b,c){w(Number.isFinite(a));w(Number.isFinite(b));w(Number.isFinite(c));c=a-this.x;for(var e=b-this.y,p=Math.ceil(Math.sqrt(c*c+e*e)/4),y=0;y<p;y++)this.x+=c/p,this.y+=e/p,this.changeCallbacks.call();this.x=a;this.y=b;this.changeCallbacks.call();return Promise.resolve()};Object.defineProperties(C.prototype,{i:{configurable:!0,enumerable:!0,get:function(){return-Math.sin(2*this.a*Math.PI)}},j:{configurable:!0,enumerable:!0,get:function(){return Math.cos(2*this.a*Math.PI)}}});function F(a,b){w(Number.isFinite(a),"x = "+a+" must be a finite number");w(Number.isFinite(b),"y = "+b+" must be a finite number");this.x=a;this.y=b}function G(a){return Math.sqrt(a.x*a.x+a.y*a.y)}function I(a,b){w(Number.isFinite(b),"magnitude = "+b+" must be a finite number");var c=G(a);return 0!==c?a.scale(b/c):J(0,0)}F.prototype.scale=function(a){w(Number.isFinite(a),"magnitude = "+a+" must be a finite number");return 0==a||0==this.x&&0==this.y?J(0,0):J(a*this.x,a*this.y)};
F.prototype.add=function(a){return J(this.x+a.x,this.y+a.y)};function K(a,b){return J(a.x-b.x,a.y-b.y)}F.prototype.toString=function(){return"V("+this.x+", "+this.y+")"};var L,J=L=function(a,b){return new F(a,b)};function M(a,b){var c=this;this.width=a;this.height=b;this.changeCallbacks=new z;this.a=new Set;var e=+new Date;setInterval(function(){var b=+new Date,a=(b-e)/1E3;e=b;if(!(0>=a)){for(var b=new Map,g=t(c.a),d=g.next();!d.done;d=g.next()){for(var l=d.value,d=L(0,0),d=d.add(l.g),u=t(c.a),h=u.next();!h.done;h=u.next())if(h=h.value,l!==h){var k=K(h.b,l.b),H=G(k);40>H&&(H=40);h=I(k,1).scale(6.67408*l.c*h.c/Math.pow(H,2));d=d.add(h)}b.set(l,d)}g=[];l=t(c.a);for(d=l.next();!d.done;d=l.next())d=d.value,u=
d.c*d.f,h=b.get(d),k=h.scale(a/u),console.log("dV from forces "+k),d.a=d.a.add(k),k=G(d.a),k=Math.max(0,k-a*k*.05),10<=k||100<G(h)/u?(console.log(String(k)),d.a=I(d.a,k)):d.a=L(0,0),0<G(d.a)&&(u=d.a.scale(a),d.b=d.b.add(u),g.push(d));for(a=0;a<g.length-1;a++)b=g[a],l=a+Math.floor(Math.random()*g.length-a),g[a]=g[l],g[l]=b;a=t(g);for(d=a.next();!d.done;d=a.next())d.value.changeCallbacks.call()}},20)}Object.defineProperties(M.prototype,{agents:{configurable:!0,enumerable:!0,get:function(){return new Set(this.a)}}});function N(a,b,c){this.b=L(void 0===b?0:b,void 0===c?0:c);this.a=L(0,0);this.g=L(0,0);this.c=1E4;this.f=1;this.h=Promise.resolve();this.changeCallbacks=new z}N.prototype.goTo=function(a,b){function c(){return new Promise(function(c){function y(){var g=K(L(a,b),e.b),d=e.b.add(e.a.scale(2)),d=K(L(a,b),d);16>=G(g)&&1>=G(e.a)?(e.g=L(0,0),c()):e.g=I(d,200*e.c*e.f)}e.changeCallbacks.add(function(){y()});y()})}var e=this;return this.h=this.h.then(c,c)};
Object.defineProperties(N.prototype,{x:{configurable:!0,enumerable:!0,get:function(){return this.b.x}},y:{configurable:!0,enumerable:!0,get:function(){return this.b.y}},z:{configurable:!0,enumerable:!0,get:function(){return 0}}});function O(a,b){var c=a+" !== "+b;if(a!==b)throw Error((void 0===c?null:c)||"Assertion failed");};function P(a,b){var c=this;this.c=1E3*Math.random();this.b=a;this.a=b;this.cancel=b.changeCallbacks.add(function(){return void Q(c,b.x,b.y,b.z)})}
function Q(a,b,c,e){b=void 0===b?0:b;c=void 0===c?0:c;e=void 0===e?0:e;A(a.b.b)&&(b-=0,c-=0,e-=0,e=Math.max(.2,Math.min(1,Math.sqrt(b*b+c*c+e*e)/100)),b=a.b.c,b.fillStyle="rgba(0, 0, 0, 0.25)",b.beginPath(),b.arc(a.a.x,a.a.y,8,0,2*Math.PI),b.fill(),b.fillStyle="hsla("+a.c+", 50%, 50%, "+e+")",b.strokeStyle="rgba(255, 255, 255, "+e+")",b.beginPath(),b.arc(a.a.x,a.a.y,6,0,2*Math.PI),b.fill(),b.stroke())}
function R(a){var b=this;this.a=a;this.b=document.createElement("canvas");this.b.width=this.a.width;this.b.height=this.a.height;this.c=this.b.getContext("2d");this.c.fillStyle="black";this.c.fillRect(0,0,this.a.width,this.a.height);this.f=new Map;this.g();this.a.changeCallbacks.add(this.g.bind(this));var c=+new Date;setInterval(function(){var a=+new Date,p=(a-c)/1E3;c=a;if(A(b.b))for(b.c.fillStyle="rgba(0, 0, 0, "+.25*p+")",b.c.fillRect(0,0,b.a.width,b.a.height),a=t(b.f.values()),p=a.next();!p.done;p=
a.next())Q(p.value);else b.c.fillStyle="black",b.c.fillRect(0,0,b.a.width,b.a.height)},100)}R.prototype.g=function(){for(var a=t(this.f),b=a.next();!b.done;b=a.next())b.value.cancel();this.f=new Map;a=t(this.a.agents);for(b=a.next();!b.done;b=a.next())b=b.value,this.f.set(b,new P(this,b))};function S(){}S.prototype.test=function(){x("Let's testTheTurtles()!");T()};S.prototype.addFlatCanvasWithTurtles=function(a){var b=new B(512,512,[]),c=new R(b);a.appendChild(c.b);T(b);return b};
S.prototype.addFlatCanvasWithFlatland=function(a){function b(){return.5+(Math.random()+Math.random()+Math.random())/3}var c=new M(512,512),e=new R(c);a.appendChild(e.b);a=new N(0,150,50);a.a=L(200,-15);c.a.add(a);console.log(a.goTo(500,500,0));a=new N(0,400,200);a.a=L(100,650);c.a.add(a);console.log(a.goTo(25,25,0));a=new N(0,150,175);a.a=L(-65,125);c.a.add(a);console.log(a.goTo(50,400,0));for(a=0;4>a;a++)e=new N(0,200+50*b(),200+50*b()),e.c*=10,e.f*=10,e.a=L(5-10*b(),5-10*b()),c.a.add(e);c.changeCallbacks.call();
return c};function T(a){a=void 0===a?new B(512,512,[]):a;var b=new C;a.a.add(b);a.changeCallbacks.call();O(50,b.x);O(50,b.y);E(b,50);O(50,b.x);O(100,b.y);w(Number.isFinite(.25));b.a+=.25;E(b,25);O(25,b.x);O(100,b.y);D(b,.375);E(b,100);for(a=0;12>a;a++)D(b,.0625),E(b,10);E(b,100);D(b,.25);E(b,200);for(a=0;6>a;a++)D(b,.0625),E(b,10);E(b,50);console.log("Test complete.")}var U=new S;"object"===typeof module&&null!=module&&(module.exports=U);"object"===typeof window&&null!=window&&(window.vxq=U);
}.call(typeof window == 'object' ? window: typeof this == 'object' ? this: null,typeof window == 'object' ? window : null,typeof module == 'object' ? module : null)
